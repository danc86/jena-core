<HTML>



<HEAD><TITLE>Jena Relational Database backend</TITLE></HEAD>



<BODY bgcolor="#FFFFFF">



<h1>Jena2 Database Interface -  Release Notes</h1>



<h3>28 August, 2003</h3>



<p>The jena/db module provides an implementation of the Jena <code>model</code> 



  interface but with the ability to store and retrieve RDF statements using a database. 
It currently supports MySQL, Oracle and PostgreSQL for persistent storage and 
runs under Linux and WindowsXP. Jena1 databases cannot be accessed by Jena2 and 
must be reloaded. Little performance tuning has been done.</p>



<h2>Contents</h2>



<blockquote>



<p><a href="#features">Features</a><br>
<a href="#remaining">Remaining Work</a><br>
<a href="#dbengines">Database Engines Supported</a><br>
<a href="#compatibility">Compatibility with Jena1 ModelRDB</a><br>
<a href="#migrating">Migrating Jena1 Applications and Databases</a><br>
<a href="#notes">Performance Notes</a></p>



</blockquote>



  <h2><a name="features"></a>Features</h2>



<p>The jena/db module provides persistence for asserted and reified statements. 
It uses a different layout than Jena1 that enables faster insertion and 
retrieval but uses more storage than Jena1. It is largely backwards-compatible 
for Jena1 applications with the exception of some database configuration 
options. The persistence subsystem supports a Fastpath capability for RDQL 
queries. This dynamically generates SQL queries to perform as much of the RDQL 
query as possible within the database engine. For an overview of creating and 
accessing persistent Jena models, see <a href="howto.html">howto.html</a>. A 
summary of the various configuration options available is given in
<a href="options.html">options.html</a>. Known issues and open problems are 
summarized in&nbsp;
  <a href="issues.html">issues.html</a>.</p>



  <h2><a name="remaining"></a>Remaining Work</h2>



  <p>In the future, we would like to address the following issues.</p>



  <ul>
    <li> <i>
  BerkeleyDB</i>  <font face="Times New Roman">- use of BerkeleyDB as a 
    persistent store is desirable for performance and compatibility with Jena1.</font></li>
    <li> <font face="Times New Roman"><i>Native Java persistence</i> - a native 
    Java persistent store would be convenient for some users.</font></li>
    <li> <font face="Times New Roman"><i>Performance tuning and characterization</i> 
    - a better understanding of the trade-offs of the various configuration 
    options would be useful.</font></li>
    <li><i>Application-specific database layouts</i> - Jena2 supports 
    reification with a property-class table but this capability should be 
    generalized to support user-defined property and property class tables.</li>
</ul>



  <h2><a name="dbengines"></a>Database Engine Support</h2>



  <p>The following table lists the platforms, database engines and JDBC drivers 
  currently supported for Jena2 persistence. Older and newer versions may work 
  but have not been tested. See the howto documents for more details (<a href="mysql-howto.html">MySQL</a>,
  <a href="oracle-howto.html">Oracle</a>,
  <a href="postgresql-howto.html">PostgreSQL</a>).</p>



<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" id="AutoNumber1">
  <tr>
    <td><b>&nbsp;&nbsp; Platform&nbsp;&nbsp;&nbsp;&nbsp; </b></td>
    <td><b>&nbsp;&nbsp; Database Engine&nbsp;&nbsp;&nbsp;&nbsp; </b></td>
    <td><b>&nbsp;&nbsp; JDBC Driver</b></td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Windows XP&nbsp; </td>
    <td>&nbsp;&nbsp; MySQL 4.0.12</td>
    <td>&nbsp;&nbsp; mysql-connector-java-3.0.7-stable.jar&nbsp;&nbsp;&nbsp;&nbsp; </td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Linux (RedHat 7.2)&nbsp;&nbsp;&nbsp;&nbsp; </td>
    <td>&nbsp;&nbsp; MySQL 4.0.12</td>
    <td>&nbsp;&nbsp; mysql-connector-java-3.0.7-stable.jar</td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Windows XP&nbsp; </td>
    <td>&nbsp;&nbsp; PostgreSQL 7.3.3</td>
    <td>&nbsp;&nbsp; pg73jdbc2.jar (JDBC2 for jdk1.3, 1.2, 1.4&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp; </td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Linux (RedHat 7.2)&nbsp;&nbsp;&nbsp;&nbsp; </td>
    <td>&nbsp;&nbsp; PostgreSQL 7.3.3</td>
    <td>&nbsp;&nbsp; pg73jdbc2.jar (JDBC2 for jdk1.3, 1.2, 1.4&nbsp;)</td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Windows XP&nbsp; </td>
    <td>&nbsp;&nbsp; Oracle 9.2.0.1.0</td>
    <td>&nbsp;&nbsp; Oracle oci8 JDBC driver (thick client)&nbsp;&nbsp;&nbsp;&nbsp; </td>
  </tr>
  <tr>
    <td>&nbsp;&nbsp; Linux (RedHat AS)&nbsp;&nbsp;&nbsp;&nbsp; </td>
    <td>&nbsp;&nbsp; Oracle 9.2.0.1.0</td>
    <td>&nbsp;&nbsp; Oracle oci JDBC driver (thick client)&nbsp;</td>
  </tr>
</table>



  <h2><a name="compatibility"></a>Compatibility with Jena1 ModelRDB and 
  Databases</h2>



  <p>In general, Jena2 supports backwards compatibility for the Jena1 
  applications using the <font face="Courier New" size="2">ModelRDB</font> 
  class. However, the Jena1 databases themselves are not compatible and cannot 
  be directly read by Jena2. Instructions on migrating Jena1 databases to Jena2 
  are given <a href="#migrating">below</a>.</p>



  <p>There are some changes to the API. <font face="Courier New" size="2">The ModelRDB</font> 
  constructors are deprecated and applications should consider migrating to new factory 
  methods for creating and opening persistent models (see
  <a href="#migrating">below</a>). The <font face="Courier New" size="2">ModelRDB</font> 
  package name has changed. Jena1 applications that directly reference the 
  package name jena.rdb must be modified to reference the package name
  <font face="Courier New" size="2">jena.db</font>. Jena2 does not support the <font face="Courier New" size="2">StoreRDB</font> 
  class nor any of the Jena1 customization parameters (setProperty, getProperty). 
  Jena2 uses a different technique for database configuration.</p>



  <p>Jena2 does not support the <i>hash</i> layouts and <i>proc</i> layouts of 
  Jena1. Applications that request these layouts under Jena2 will be given a 
  generic layout. Jena2 will initially support MySQL, Oracle, Postgresql and 
  Berkeley DB. Applications that require Interbase will not work. The driver 
  configuration files (e.g., Mysql.config) are no longer used. Instead, 
  configuration options are set and retrieved using statements in an RDF memory 
  model.</p>



  <p>In Jena2, all databases are multi-model. By default, each model is 
  stored in separate tables and two tables are used for each model, one for 
  asserted statements and another for reified statements. To share tables among models, see
  <a href="#migrating">migrating</a>, below.</p>



  <p>Performance of Jena2 
  persistent models is no worse than Jena1 and often better. However, Jena2 
  persistent models may consume more database space. See the <a href="#notes">Performance Notes</a>.</p>



  <h2><a name="migrating"></a>Migrating Jena1 Applications and Databases to 
  Jena2</h2>



  <p>As mentioned <a href="#compatibility">above</a>, most Jena1 persistent 
  applications should run with little or no modification under Jena2. However, 
  some <font face="Courier New" size="2">ModelRDB</font> class constructors are deprecated. In 
  Jena2, persistent models should be created using a factory method.</p>



  <p>The Jena2 
  persistence architecture and layout are  different from Jena1. However, 
  these differences are largely transparent to applications and only affect code 
  that creates new persistent models. In particular, the way in which database 
  configuration options are specified is changed. In Jena2, configuration options are specified 
  using get and set methods on models or drivers. See <a href="options.html">
  Options</a> details on the options and how to specify them.</p>



  <p>To migrate databases, a small Jena1 application program is used to write 
  Jena1 <font face="Courier New" size="2">ModelRDB</font> contents to a text 
  file using an RDF writer. A small Jena2 application program is then used to 
  read this file and store it in a <font face="Courier New" size="2">ModelDB</font> 
  model. For small databases, the PrettyWriter (RDF/XML-ABBREV) should be 
  adequate. For medium or large databases, use the N-Triple writer for better 
  performance and consider using a pipe to connect the two small applications 
  rather than using an intermediate file. As a convenience, the preview release 
  will provide a script or utility program for database migration.</p>



  <h2><a name="notes"></a>Performance Notes</h2>



  <p>Very little tuning or performance analysis has been done. Early 
  measurements of the Jena2 preview 1 release using the jena-perf benchmark (available as a package 
  from <a href="http://sourceforge.net/projects/jena/">
  http://sourceforge.net/projects/jena/</a>) show Jena2 to be up to three times 
  faster than Jena1 (see <a href="perftestWin32.html">perftest.html</a>). 
  However, Jena2 models may consume more disk space than Jena1 models. This is due to the different table layouts used in Jena1 and 
  Jena2. In Jena1, all resources were stored in a separate table that was referenced 
  from the statement table. Similarly for all literals. This greatly reduced space 
  consumption since resources and literals that appeared in multiple statements 
  were only stored once. However, retrieving a statement required joining the 
  statement table with the literals and resources tables.</p>



  <p>In Jena2, <i>short</i> resources and <i>short</i> literals are stored directly in the statement table.
  Separate tables for resources and literals exist but are only used for objects
  whose length exceeds some threshold. The threshold has a database-dependent 
  default but may be redefined by users (see <a href="options.html">LongObjectLength</a>). Consequently, Jena2 requires fewer join operations than 
  Jena1 at the expense of greater memory consumption. If disk space consumption 
  is deemed excessive, two options may be used to reduce the amount of space 
  used, <a href="options.html">DoCompressURI</a>&nbsp; and 
  &nbsp;<a href="options.html">LongObjectLength </a>.</p>



  <p>Little performance tuning has been done. For loading large databases, we 
  have found two techniques can help. First, if the dataset to be loaded 
  contains no duplicate statements, the option 
  <a href="options.html">DoDuplicateCheck</a> &nbsp;may be used to disable checking for duplicate statements on 
  insertion. Another option is to manually delete the database indexes and then 
  recreate them after the loading has completed. Unfortunately, Jena2 does not 
  currently support a utility to do this on behalf of users. We cannot provide 
  any guidance on the benefit of deleting and recreating the indexes and mention 
  it only as an option users may wish to try if load performance cannot be 
  improved with other techniques.</p>



</BODY>



</HTML>