<HTML>



<HEAD>
<TITLE>Jena Relational Database backend</TITLE>
<link href="../styles/usermanual.css" rel="stylesheet" type="text/css" />
</HEAD>



<BODY bgcolor="#FFFFFF">



<h1>Jena2 Database Interface - Performance Notes</h1>



<h3>28 August, 2003</h3>



  <p>Very little tuning or performance analysis has been done. However, a simple
  performance comparison of Jena1 and Jena2 on both memory and persistent models
  was performed using the jena-perf benchmark (available 
  from <a href="http://sourceforge.net/projects/jena/">
  http://sourceforge.net/projects/jena/</a>). This showed Jena2 to be up to three times 
  faster than Jena1 (see <a href="perftestWin32.html">perftest</a>). 
  However, Jena2 models may consume more disk space than Jena1 models. This is due to the different table layouts used in Jena1 and 
  Jena2 (see <a href="perftestSpaceWin32.html">perftestSpace</a>). In Jena1, all resources
  and literals were stored in separate tables that were referenced 
  from the statement table. This greatly reduced space 
  consumption since resources and literals that appeared in multiple statements 
  were only stored once. However, retrieving a statement required joining the 
  statement table with the literals and resources tables.</p>



  <p>In Jena2, <i>short</i> resources and <i>short</i> literals are stored directly in the statement table.
  Separate tables for resources and literals exist but are only used for objects
  whose length exceeds some threshold. The threshold has a database-dependent 
  default but may be redefined by users (see <a href="options.html">LongObjectLength</a>). Consequently, Jena2 requires fewer join operations than 
  Jena1 at the expense of greater memory consumption. Reducing the value of
  LongObjectLength can reduce disk space consumption. Jena2 offers another
  mechanism to reduce disk space consumption. Often, resource URIs have common
  prefixes. By default, URIs are stored fully expanded in statement tables.
  However, the <a href="options.html">DoCompressURI</a>&nbsp;option can be used
  to compress URIs by storing common prefixes in a separate table and encoding
  the URI in a statement table with a reference to the prefix table.</p>



  <p> For loading large databases, two techniques can be used to reduce load
  time. First, if the dataset to be loaded 
  contains no duplicate statements, the option 
  <a href="options.html">DoDuplicateCheck</a> &nbsp;may be used to disable checking for duplicate statements on 
  insertion. Another option is to manually delete the database indexes and then 
  recreate them after the loading has completed. Unfortunately, Jena2 does not 
  currently support a utility to do this on behalf of users. We cannot provide 
  any guidance on the benefit of deleting and recreating the indexes and mention 
  it only as an option users may wish to try if load performance cannot be 
  improved through other techniques.</p>



  <h2><a name="dbengines"><span style="background-position: 0 0">Effect of 
  Database Options on Loading</span></a></h2>



  <p>A simple study was conducted to determine the effect of some of the 
  database options on database space and load time. A synthetic test data set 
  consisting of 1000 Dublin Core documents was loaded under various 
  configurations. This data set contains 22,000 RDF statements with no duplicate statements. Some property values
  are long. The tests were run 
  using MySQL on WindowsXP. For this data set, the table below shows how the
  various option settings enable trade-offs between space and time. The results
  should not be considered representative because the impact of these option
  settings is dependent on the characteristics of the data set.</p>



<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="852" id="AutoNumber3">
  <tr>
    <td style="text-align: left" width="260"><b>Option Settings</b></td>
    <td width="138"><b>Database Space</b></td>
    <td width="111"><b>Load Time</b></td>
    <td width="426" style="text-align: left"><b>Comments</b></td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">Default option settings (long
      object length = 250 bytes, URI compression disabled, duplicate checked
      enabled)</td>
    <td width="138" style="text-align: right">16.38 MB</td>
    <td width="111" style="text-align: right">29.5 sec.</td>
    <td width="426" style="text-align: left">Default long object length of 250, 
    dup checking enabled, no compression.</td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">Duplicate checking disabled</td>
    <td width="138" style="text-align: right">16.38 MB</td>
    <td width="111" style="text-align: right">16.3 sec.</td>
    <td width="426" style="text-align: left">Only usable if no duplicates in 
    load set.</td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">Long object length = 25 bytes</td>
    <td width="138" style="text-align: right">9.62 MB</td>
    <td width="111" style="text-align: right">58.7 sec.</td>
    <td width="426" style="text-align: left">Heavy use of literals and resources 
    table.</td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">Long object length = 50 bytes</td>
    <td width="138" style="text-align: right">13.40 MB</td>
    <td width="111" style="text-align: right">35.3 sec.</td>
    <td width="426" style="text-align: left">Moderate increased time and reduced
      space.</td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">Long object length = 100 bytes</td>
    <td width="138" style="text-align: right">15.50 MB</td>
    <td width="111" style="text-align: right">29.5 sec.</td>
    <td width="426" style="text-align: left">Similar to default case.</td>
  </tr>
  <tr>
    <td style="text-align: left" width="260">URI compression enabled, length = 20 bytes,
      cache size = 100</td>
    <td width="138" style="text-align: right">9.01 MB</td>
    <td width="111" style="text-align: right">24.0 sec.</td>
    <td width="426" style="text-align: left">Use of memory cache for URIs is 
    beneficial.</td>
  </tr>
</table>



  </BODY>



</HTML>