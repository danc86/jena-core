<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "Microsoft FrontPage 6.0" />

  <title>Function Library in ARQ</title>
  <link rel="stylesheet" type="text/css" href="styles/doc.css" />
</head>

<body>
  <h1>Functions in ARQ</h1>

  <p>SPARQL allows custom functions in filter expressions so that
  queries can be used on domain-specific data. SPARQL defines a
  function by URI (or qname) in FILTER expressions.&nbsp; ARQ
  provides a function library and supports application-provided
  functions.&nbsp; Functions and extensions can be <a href=
  "extension.html">registered or dynamically loaded</a>.</p>

  <p>More functions will be added. Contributions welcome.</p>
  <p>Applications can also <a href="writing_functions.html">provide their own 
  functions</a>.</p>

  <h2><a id="functions" name="functions">Function Library</a></h2>

  <p>The prefix <code>jfn</code> is
  <code>&lt;java:com.hp.hpl.jena.query.function.library.&gt;</code>.</p>

  <p>Note the final dot in the prefix.</p>

  <p><b>RDF Graph Functions</b></p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    border="1" cellpadding="0" cellspacing="1" width="90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Function name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:listMember(<i>list</i>,
          <i>resource</i>)</code></td>

          <td style="text-align: left;">Test whether a resource is
          a member of an RDF collection (AKA list)</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:listIndex(<i>list</i>,
          <i>resource</i>)</code></td>

          <td style="text-align: left;">Return the index of the
          resource in the RDF collection. Cause an evaluation
          exception if not a member (and so the expression will not
          pass the filter unless inside a value disjunction).</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:bagMember(<i>bag</i>,
          <i>resource</i>)</code></td>

          <td style="text-align: left;">Test whether a resource is
          a member of an RDF bag</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:seqMember(<i>bag</i>,
          <i>resource</i>)</code></td>

          <td style="text-align: left;">Test whether a resource is
          a member of an RDF seq</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:altMember(<i>bag</i>,
          <i>resource</i>)</code></td>

          <td style="text-align: left;">Test whether a resource is
          a member of an RDF alt</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:langeq(<i>literal</i>, <i>lang</i>)</code></td>

          <td style="text-align: left;">Compare the language tag of
          the literal with a language tag. Comparison reflects
          language tag rules so "foo"@en matches "EN-gb".</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:bnode(?x)</code></td>

          <td style="text-align: left;">Return the blank node label
          if ?x is a blank node.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p><b>String Functions</b></p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    id="table2" border="1" cellpadding="0" cellspacing="1" width=
    "90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Function name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:concat(string1,
          string2)</code></td>

          <td style="text-align: left;">Return the concatenation of
          two strings.</td>
        </tr>
		<tr>
          <td style="text-align: left;"><code>jfn:substring(string,
          beginIndex [,endIndex])</code></td>

          <td style="text-align: left;">Returns the substring of a string, given 
			by <code>beginIndex </code>&nbsp;(integer) and, optionally, an <code>
			endIndex</code>.&nbsp; 
			Absence of <code>endIndex</code> means to end of string.&nbsp; Strings are indexed from zero.</td>
        </tr>
		<tr>
          <td style="text-align: left;"><code>jfn:substr(string,
          beginIndex [,endIndex])</code></td>

          <td style="text-align: left;">Synonym for jfn:substring.</td>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:strlen()</code></td>

          <td style="text-align: left;">Return the length of a string.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p><b>Mathematical Functions</b></p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    border="1" cellpadding="0" cellspacing="1" width="90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Function name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:min(num1,
          num2)</code></td>

          <td style="text-align: left;">Return the minimum of two
          expressions evaluating to numbers.</td>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:max(num1,
          num2)</code></td>

          <td style="text-align: left;">Return the maximum of two
          expressions evaluating to numbers.</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:round(v)</code></td>

          <td style="text-align: left;">Return the nearest integer
          value to the argument.</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:abs(v)</code></td>

          <td style="text-align: left;">Return the absolute
          value.</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:floor(v)</code></td>

          <td style="text-align: left;">Return the greatest integer
          value less than the argument (as a double).</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:ceiling(v)</code></td>

          <td style="text-align: left;">Return the smallest integer
          value than the argument (as a double).</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p><b>Miscellaneous Functions</b></p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    border="1" cellpadding="0" cellspacing="1" width="90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Function name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:now()</code></td>

          <td style="text-align: left;">Current time.&nbsp;
          Actually, the time the query started.</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:sha1sum(<i>resource</i>)</code></td>

          <td style="text-align: left;">Calculate the SHA1 checksum
          of a literal or URI.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p><b>Debugging Functions</b></p>

  <p>Debugging functions can be inserted into queries as extra
  <code>FILTER</code> clauses.&nbsp; They don't affect query
  results (they always return true) but they print information that
  can be helpful in understanding what's happening.</p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    id="table1" border="1" cellpadding="0" cellspacing="1" width=
    "90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Function name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jfn:print(expr,
          ...)</code></td>

          <td style="text-align: left;">Print the evaluated
          expressions. With no arguments, prints the current
          solution. Always returns true.</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jfn:trace(expr)</code></td>

          <td style="text-align: left;">Print the expression with
          values substituted for variables if the variable is set
          and print result of evaluation, including whether there
          was an evaluation exception. Always returns true so it
          does not filter based on the expression.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p>Example:</p>
  <pre class="box">
{
   ...
   FILTER jfn:print() # Print the solution
   FILTER jfn:trace(<i>expression</i>) # Evaluate and print the expression
   FILTER <i>expression</i> # Now use the expression to filter solutions
   ...
}
</pre>

  <h2><a name="fprops" id="fprops">Function Property
  Library</a></h2>

  <p>The prefix <code>list:</code> is <code>http://www.jena.hpl.hp.com/ARQ/list#</code>.</p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    id="table1" border="1" cellpadding="0" cellspacing="1" width=
    "90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Property name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>list:member</code></td>

          <td style="text-align: left;">Membership of an RDF List
          (RDF Collection)</td>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>rdfs:member</code></td>

          <td style="text-align: left;">Membershp of an RDF
          Container (rdf:Bag, rdf:Seq, rdf:Alt)<br /></td>
        </tr>
      </tbody>
    </table>
  </div>

  <h2><a name="extensions" id="extensions">Extension
  Library</a></h2>

  <p>The prefix <code>jext</code> is
  <code>&lt;java:com.hp.hpl.jena.query.extension.library.&gt;</code>.</p>

  <p>Extensions are not part of SPARQL; the application will need
  to use the ARQ query language (a superset of SPARQL). Unlike a
  value function, an extension can set variables and generate
  multiple solutions. Extensions are written:</p>
  <pre class="box">
EXT q:name(?a, ?b, ?c)
</pre>

  <p>Note the final dot in the prefix.</p>

  <div style="margin-left: 5%; margin-right: 5%;">
    <table style="border-style: solid; border-collapse: collapse;"
    id="table3" border="1" cellpadding="0" cellspacing="1" width=
    "90%">
      <tbody>
        <tr>
          <th style="text-align: left;" bgcolor="#C0C0C0" width=
          "40%">Extension name</th>

          <th bgcolor="#C0C0C0" width="60%">Description</th>
        </tr>

        <tr>
          <td style="text-align: left;">
          <code>jext:list(<i>list</i>, <i>member</i>)</code></td>

          <td style="text-align: left;">The argument <i>list</i>
          must be bound by this point in the query or a constant
          expression. If <i>list</i> is bound or a URI, and
          <i>member</i> a variable, generate solutions with
          <i>member</i> bound to each element in the list. If
          <i>member</i> is bound or a constant expression, test to
          see if a member of the list.</td>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jext:bag(<i>bag</i>,
          <i>member</i>)</code></td>

          <td style="text-align: left;">The argument <i>bag</i>
          must be bound by this point in the query or a constant
          expression. If <i>bag</i> is bound or a URI, and
          <i>member</i> a variable, generate solutions with
          <i>member</i> bound to each element in the bag. If
          <i>member</i> is bound or a constant expression, test to
          see if a member of the list.</td>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jext:seq(<i>seq</i>,
          <i>member</i>)</code></td>

          <td style="text-align: left;">The argument <i>seq</i>
          must be bound by this point in the query or a constant
          expression. If <i>seq</i> is bound or a URI, and
          <i>member</i> a variable, generate solutions with
          <i>member</i> bound to each element in the sequence. If
          <i>member</i> is bound or a constant expression, test to
          see if a member of the list.</td>
        </tr>

        <tr>
          <td style="text-align: left;"><code>jext:alt(<i>alt</i>,
          <i>member</i>)</code></td>

          <td style="text-align: left;">The argument <i>alt</i>
          must be bound by this point in the query or a constant
          expression. If <i>alt</i> is bound or a URI, and
          <i>member</i> a variable, generate solutions with
          <i>member</i> bound to each element in the alt . If
          <i>member</i> is bound or a constant expression, test to
          see if a member of the list.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p> </p>

  <p class="footnote"><a href="documentation.html">ARQ
  Documentation Page</a></p>
</body>
</html>
